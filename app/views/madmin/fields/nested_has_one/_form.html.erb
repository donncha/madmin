<% object = field.value(record) || field.to_model.new %>

<div class="container space-y-8" data-controller="nested-form">
  <%= form.fields_for field.attribute_name, object do |nested_form| %>
    <%= render(
      partial: field.to_partial_path('fields'),
      locals: {
        f: nested_form,
        field: field
      }
    ) %>
  <% end %>
</div>
